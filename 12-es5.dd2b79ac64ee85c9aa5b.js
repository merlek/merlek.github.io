function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{jdp0:function(t,e,n){"use strict";n.r(e);var r,i=n("8Y7J"),a=function t(){_classCallCheck(this,t)},o=n("pMnS"),s=n("UMXM"),u=n("uclk"),l=n("oFjw"),c=.9,h=((r=function(t){function e(t,n){var r;return _classCallCheck(this,e),(r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t,n))).draw=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.ctx;t.save(),t.fillStyle=e.BACKGROUND_COLOR,t.fillRect(0,0,r.canvas.width,r.canvas.height),t.lineWidth=.01*r.canvas.width,t.strokeStyle="rgb(200,200,200)";for(var n=r.canvas.height*(1-c)/2,i=1;i<r.grid.cols;i++)s.a.drawLine(t,new l.b(r.x(i),r.y(0)*c+n),new l.b(r.x(i),r.y(r.grid.rows)*c+n));for(var a=r.canvas.width*(1-c)/2,o=1;o<r.grid.cols;o++)s.a.drawLine(t,new l.b(r.x(0)*c+a,r.y(o)),new l.b(r.x(r.grid.rows)*c+a,r.y(o)));t.restore()},r}return _inherits(e,t),e}(u.a)).BACKGROUND_COLOR="#232323",r),d=c,f=function(t){function e(t,n){var r;return _classCallCheck(this,e),(r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t,n))).draw=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ctx;r.clear(),e.lineWidth=.01*r.canvas.width;for(var n=0;n<t.cols;n++)for(var i=0;i<t.rows;i++)r.drawMarker(t.get({x:n,y:i}))(e,n,i)},r.drawMarker=function(t){switch(t){case"X":return r.drawMarkerX;case"O":return r.drawMarkerO;default:return function(){}}},r.drawMarkerX=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"white";t.save();var a=r.x(1),o=r.y(1),u=r.canvas.width*(1-d)/2,c=r.canvas.height*(1-d)/2;t.strokeStyle=i,s.a.drawLine(t,new l.b(r.x(e)+u,r.y(n)+c),new l.b(r.x(e)+a-u,r.y(n)+o-c)),s.a.drawLine(t,new l.b(r.x(e)+u,r.y(n)+o-c),new l.b(r.x(e)+a-u,r.y(n)+c)),t.restore()},r.drawMarkerO=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"white";t.save();var a=r.x(1),o=r.y(1),s=r.canvas.width*(1-d)/2,u=r.canvas.height*(1-d)/2,l=(Math.min(a,o)*d-Math.min(s,u))/2;t.strokeStyle=i,t.beginPath(),t.arc(r.x(e)+a/2,r.y(n)+o/2,l,0,2*Math.PI),t.stroke(),t.closePath(),t.restore()},r}return _inherits(e,t),e}(u.a),v=function(t){function e(t,n){var r;return _classCallCheck(this,e),(r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t,n))).draw=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ctx;t.winner&&(r.clear(),r.drawText(e,t.winner,t.isAiTurn))},r.drawText=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.canvas.width/2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.canvas.height/2,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s.a.getFont(r.y(1)),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"rgba(100,100,100,0.9)";t.save(),t.fillStyle=u,t.fillRect(0,r.y(1),r.canvas.width,r.y(1)),s.a.drawText(t,"tie"===e?"tie!":e+" wins!",i,a,r.canvas.width*c,o,"tie"===e?"white":n?"green":"red"),t.restore()},r}return _inherits(e,t),e}(u.a),g=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;_classCallCheck(this,t),this.cols=n,this.rows=r,this.board=[],this.turns=0,this.next=function(){return new t(e.cols,e.rows)};for(var i=0;i<this.cols;i++)this.board[i]=[]}return _createClass(t,[{key:"get",value:function(t){var e=t.x,n=t.y;return this.board[e]?this.board[e][n]:void 0}},{key:"set",value:function(t,e){var n=t.x,r=t.y;this.board[n][r]=e}},{key:"setIfAble",value:function(t,e){var n=!1;return this.winner||(this.get(e)||(this.set(e,t),n=!0),this.checkWinner()),n}},{key:"setNextTurn",value:function(t){var e=!1;return t&&this.setIfAble(this.getTurn(),t)&&(this.nextTurn(),e=!0),e}},{key:"takeTurn",value:function(t){this.setNextTurn(t)}},{key:"nextTurn",value:function(){return this.turns++%2==0?"X":"O"}},{key:"getTurn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.turns;return t%2==0?"X":"O"}},{key:"checkWinner",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(t=this.checkColWins())||(t=this.checkRowWins())||(t=this.checkDiagonalWins())||this.checkBoardFull()&&(t="tie"),e&&(this.winner=t),t}},{key:"checkColWins",value:function(){for(var t=0;t<this.cols;t++){for(var e=this.get({x:t,y:0}),n=1;n<this.rows;n++)e!==this.get({x:t,y:n})&&(e=void 0);if(e)return e}}},{key:"checkRowWins",value:function(){for(var t=0;t<this.cols;t++){for(var e=this.get({x:0,y:t}),n=1;n<this.rows;n++)e!==this.get({x:n,y:t})&&(e=void 0);if(e)return e}}},{key:"checkDiagonalWins",value:function(){for(var t=this.get({x:0,y:0}),e=this.get({x:0,y:this.rows-1}),n=1;n<this.cols;n++)t!==this.get({x:n,y:n})&&(t=void 0),e!==this.get({x:n,y:this.rows-1-n})&&(e=void 0);return t||e}},{key:"checkBoardFull",value:function(){for(var t=0;t<this.cols;t++)for(var e=0;e<this.rows;e++)if(!this.get({x:t,y:e}))return!1;return!0}}]),t}(),w=n("dQPR"),y=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),r=[t[n],t[e]];t[e]=r[0],t[n]=r[1]}return t},b=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0===Object(w.b)(0)(2);return _classCallCheck(this,e),(t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,n,r))).isAiTurn=i,t.next=function(){return new e(t.cols,t.rows)},t.bestMove=function(){return t.minimax().move},t.scores=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"tie"===e?0:e===t.getTurn()?10-n:-10+n},t.player=function(e){return e?t.getTurn():t.getTurn(t.turns+1)},t}return _inherits(e,t),_createClass(e,[{key:"takeTurn",value:function(t){if(this.isAiTurn&&!this.checkWinner()){for(;!this.setNextTurn(this.bestMove()););this.checkWinner(),this.isAiTurn=!1}else this.isAiTurn=this.setNextTurn(t)}},{key:"getAvailableMoves",value:function(){for(var t=[],e=0;e<this.cols;e++)for(var n=0;n<this.rows;n++)this.get({x:e,y:n})||t.push(new l.b(e,n));return t}},{key:"minimax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1/0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=t.checkWinner(!1);if(void 0!==a)return{score:this.scores(a,e)};var o,s=y(t.getAvailableMoves()),u=i?-1/0:1/0,l=function(t,e){return i?t>e:t<e},c=!0,h=!1,d=void 0;try{for(var f,v=s[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var g=f.value;t.set(g,this.player(i));var w=this.minimax(t,e+1,n,r,!i),b=w.score;if(t.set(g,void 0),l(b,u)&&(u=b,o=g),i?n=Math.max(n,b):r=Math.min(r,b),r<=n)break}}catch(m){h=!0,d=m}finally{try{c||null==v.return||v.return()}finally{if(h)throw d}}return{score:u,move:o}}}]),e}(g),m=function(){function t(e,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new b;_classCallCheck(this,t),this.state=a,this.fps=60,this.update=function(t){return function(e){e-t>1e3/i.fps?(i.state.takeTurn(),i.gameAnimator.draw(i.state),i.state.winner?(i.uiAnimator.draw(i.state),i.state=i.state.next(),setTimeout((function(){i.animationFrameId=window.requestAnimationFrame(i.update(e))}),2e3)):(i.uiAnimator.clear(),i.animationFrameId=window.requestAnimationFrame(i.update(e)))):i.animationFrameId=window.requestAnimationFrame(i.update(t))}},this.gameAnimator=new f(e,a),this.backgroundAnimator=new h(n,a),this.uiAnimator=new v(r,a);for(var o=function(t){return Math.round(t*r.width/i.state.cols)},u=function(t){return Math.round(t*r.height/i.state.rows)},l=[],c=function(t){for(var e=function(e){l.push({x:o(t),y:u(e),width:o(1),height:u(1),enabled:!0,onClick:function(){i.state.takeTurn({x:t,y:e})}})},n=0;n<a.rows;n++)e(n)},d=0;d<a.cols;d++)c(d);s.a.addButtonClickEventListener(r,l)}return _createClass(t,[{key:"start",value:function(){this.backgroundAnimator.draw(),this.gameAnimator.draw(this.state),this.animationFrameId=window.requestAnimationFrame(this.update(0))}},{key:"ngOnDestroy",value:function(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId)}}]),t}(),k=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){this.scaleCanvas(),this.animator=new m(document.getElementById("game-layer"),document.getElementById("background-layer"),document.getElementById("ui-layer")),this.animator.start()}},{key:"ngOnDestroy",value:function(){this.animator.ngOnDestroy()}},{key:"scaleCanvas",value:function(t){var e=document.getElementById("menu"),n=document.getElementById("main"),r=document.getElementById("stage"),i=document.getElementById("background-layer"),a=(window.innerHeight-e.offsetHeight-10)/i.height,o=n.offsetWidth/i.width,s=Math.min(o,a);Math.max(o,a),r.style.transformOrigin="0 0",r.style.transform="scale("+s+")"}}]),t}(),p=i.vb({encapsulation:0,styles:[["#stage[_ngcontent-%COMP%]{width:900px;height:900px;position:relative;box-sizing:content-box;border:1px solid;background-color:#fff}#stage[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}#stage[_ngcontent-%COMP%]   #ui-layer[_ngcontent-%COMP%]{z-index:3}#stage[_ngcontent-%COMP%]   #game-layer[_ngcontent-%COMP%]{z-index:2}#stage[_ngcontent-%COMP%]   #background-layer[_ngcontent-%COMP%]{z-index:1}"]],data:{}});function x(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,3,"div",[["id","stage"]],null,null,null,null,null)),(t()(),i.xb(1,0,null,null,0,"canvas",[["height","900"],["id","ui-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(2,0,null,null,0,"canvas",[["height","900"],["id","game-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(3,0,null,null,0,"canvas",[["height","900"],["id","background-layer"],["width","900"]],null,null,null,null,null))],null,null)}var _=i.tb("app-tic-tac-toe",k,(function(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,1,"app-tic-tac-toe",[],null,[["window","resize"]],(function(t,e,n){var r=!0;return"window:resize"===e&&(r=!1!==i.Jb(t,1).scaleCanvas(n)&&r),r}),x,p)),i.wb(1,245760,null,0,k,[],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),C=n("SVse"),O=n("iInd"),M=function t(){_classCallCheck(this,t)};n.d(e,"TicTacToeModuleNgFactory",(function(){return T}));var T=i.ub(a,[],(function(t){return i.Gb([i.Hb(512,i.l,i.fb,[[8,[o.a,_]],[3,i.l],i.B]),i.Hb(4608,C.o,C.n,[i.x,[2,C.D]]),i.Hb(1073742336,C.b,C.b,[]),i.Hb(1073742336,O.o,O.o,[[2,O.t],[2,O.k]]),i.Hb(1073742336,M,M,[]),i.Hb(1073742336,a,a,[]),i.Hb(1024,O.i,(function(){return[[{path:"",component:k}]]}),[])])}))}}]);