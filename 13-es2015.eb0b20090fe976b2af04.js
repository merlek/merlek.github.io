(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{jdp0:function(t,e,i){"use strict";i.r(e);var s=i("8Y7J");class n{}var r=i("pMnS"),a=i("26NK");const h="X",o="O";class l{constructor(t=3,e=3){this.cols=t,this.rows=e,this.board=[],this.turns=0,this.next=()=>new l(this.cols,this.rows);for(let i=0;i<this.cols;i++)this.board[i]=[]}get({x:t,y:e}){return this.board[t]?this.board[t][e]:void 0}set({x:t,y:e},i){this.board[t][e]=i}setIfAble(t,e){let i=!1;return this.winner||(this.get(e)||(this.set(e,t),i=!0),this.checkWinner()),i}setNextTurn(t){let e=!1;return t&&this.setIfAble(this.getTurn(),t)&&(this.nextTurn(),e=!0),e}takeTurn(t){this.setNextTurn(t)}nextTurn(){return this.turns++%2==0?h:o}getTurn(t=this.turns){return t%2==0?h:o}checkWinner(t=!0){let e;return(e=this.checkColWins())||(e=this.checkRowWins())||(e=this.checkDiagonalWins())||this.checkBoardFull()&&(e="tie"),t&&(this.winner=e),e}checkColWins(){for(let t=0;t<this.cols;t++){let e=this.get({x:t,y:0});for(let i=1;i<this.rows;i++)e!==this.get({x:t,y:i})&&(e=void 0);if(e)return e}}checkRowWins(){for(let t=0;t<this.cols;t++){let e=this.get({x:0,y:t});for(let i=1;i<this.rows;i++)e!==this.get({x:i,y:t})&&(e=void 0);if(e)return e}}checkDiagonalWins(){let t=this.get({x:0,y:0}),e=this.get({x:0,y:this.rows-1});for(let i=1;i<this.cols;i++)t!==this.get({x:i,y:i})&&(t=void 0),e!==this.get({x:i,y:this.rows-1-i})&&(e=void 0);return t||e}checkBoardFull(){for(let t=0;t<this.cols;t++)for(let e=0;e<this.rows;e++)if(!this.get({x:t,y:e}))return!1;return!0}}var c=i("YTka");const u=t=>{for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t};class d extends l{constructor(t=3,e=3,i=Object(c.randomInt)(0)(2)){super(t,e),this.aiPlayer=i,this.next=()=>new d(this.cols,this.rows),this.bestMove=()=>this.minimax().move,this.scores=(t,e=0)=>"tie"===t?0:t===this.getTurn()?10-e:-10+e,this.player=t=>t?this.getTurn():this.getTurn(this.turns+1),this.isAiTurn=()=>this.turns%2===this.aiPlayer}takeTurn(t){if(this.isAiTurn()&&!this.checkWinner()){for(;!this.setNextTurn(this.bestMove()););this.checkWinner()}else this.setNextTurn(t)}getAvailableMoves(){const t=[];for(let e=0;e<this.cols;e++)for(let i=0;i<this.rows;i++)this.get({x:e,y:i})||t.push(a.Point.create(e,i));return t}minimax(t=this,e=0,i=-1/0,s=1/0,n=!0){const r=t.checkWinner(!1);if(void 0!==r)return{score:this.scores(r,e)};const a=u(t.getAvailableMoves());let h,o=n?-1/0:1/0;const l=(t,e)=>n?t>e:t<e;for(const c of a){t.set(c,this.player(n));const{score:r}=this.minimax(t,e+1,i,s,!n);if(t.set(c,void 0),l(r,o)&&(o=r,h=c),n?i=Math.max(i,r):s=Math.min(s,r),s<=i)break}return{score:o,move:h}}}const w=.9;let g=(()=>{class t extends a.Animators.CanvasGridAnimator{constructor(e,i){super(e,i),this.draw=(e=this.ctx)=>{e.save(),e.fillStyle=t.BACKGROUND_COLOR,e.fillRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=.01*this.canvas.width,e.strokeStyle="rgb(200,200,200)";const i=this.canvas.height*(1-w)/2;for(let t=1;t<this.grid.cols;t++)a.Line.draw(e,{start:a.Point.create(this.x(t),this.y(0)*w+i),end:a.Point.create(this.x(t),this.y(this.grid.rows)*w+i)});const s=this.canvas.width*(1-w)/2;for(let t=1;t<this.grid.cols;t++)a.Line.draw(e,{start:a.Point.create(this.x(0)*w+s,this.y(t)),end:a.Point.create(this.x(this.grid.rows)*w+s,this.y(t))});e.restore()}}}return t.BACKGROUND_COLOR="#232323",t})();const m=w,x=t=>"human"===t?"#33ff33":"ai"===t?"#ff3333":"white",y=t=>t instanceof d?e=>e===(t.aiPlayer?"O":"X")?"ai":"human":()=>void 0;class f extends a.Animators.CanvasGridAnimator{constructor(t,e){super(t,e),this.draw=(t,e=this.ctx)=>{this.clear();const i=y(t);e.lineWidth=.01*this.canvas.width;for(let s=0;s<t.cols;s++)for(let n=0;n<t.rows;n++){const r=t.get({x:s,y:n});this.drawMarker(r,i(r))(e,s,n)}},this.drawMarker=(t,e)=>{switch(t){case"X":return this.drawMarkerX(e);case"O":return this.drawMarkerO(e);default:return()=>{}}},this.drawMarkerX=t=>(e,i,s,n=x(t))=>{e.save();const r=this.x(1),h=this.y(1),o=this.canvas.width*(1-m)/2,l=this.canvas.height*(1-m)/2;e.strokeStyle=n,a.Line.draw(e,{start:a.Point.create(this.x(i)+o,this.y(s)+l),end:a.Point.create(this.x(i)+r-o,this.y(s)+h-l)}),a.Line.draw(e,{start:a.Point.create(this.x(i)+o,this.y(s)+h-l),end:a.Point.create(this.x(i)+r-o,this.y(s)+l)}),e.restore()},this.drawMarkerO=t=>(e,i,s,n=x(t))=>{e.save();const r=this.x(1),a=this.y(1),h=this.canvas.width*(1-m)/2,o=this.canvas.height*(1-m)/2,l=(Math.min(r,a)*m-Math.min(h,o))/2;e.strokeStyle=n,e.beginPath(),e.arc(this.x(i)+r/2,this.y(s)+a/2,l,0,2*Math.PI),e.stroke(),e.closePath(),e.restore()}}}class v extends a.Animators.CanvasGridAnimator{constructor(t,e){super(t,e),this.draw=(t,e=this.ctx)=>{t.winner&&(this.clear(),this.drawText(e,t.winner,t.isAiTurn()?"human":"ai"))},this.drawText=(t,e,i,s=this.canvas.width/2,n=this.canvas.height/2,r=a.Text.getFont(this.y(1)),h="rgba(100,100,100,0.95)",o=x("tie"===e?"tie":i))=>{t.save(),t.fillStyle=h,t.fillRect(0,this.y(1),this.canvas.width,this.y(1)),a.Text.draw(t,{text:"tie"===e?"tie!":e+" wins!",x:s,y:n,maxWidth:this.canvas.width*w,font:r,fillStyle:o}),t.restore()}}}class b{constructor(t,e,i,s=new d){this.state=s,this.fps=60,this.update=t=>e=>{e-t>1e3/this.fps?(this.state.takeTurn(),this.gameAnimator.draw(this.state),this.state.winner?(this.uiAnimator.draw(this.state),this.state=this.state.next(),setTimeout(()=>{this.animationFrameId=window.requestAnimationFrame(this.update(e))},2e3)):(this.uiAnimator.clear(),this.animationFrameId=window.requestAnimationFrame(this.update(e)))):this.animationFrameId=window.requestAnimationFrame(this.update(t))},this.gameAnimator=new f(t,s),this.backgroundAnimator=new g(e,s),this.uiAnimator=new v(i,s);const n=t=>Math.round(t*i.width/this.state.cols),r=t=>Math.round(t*i.height/this.state.rows),h=[];for(let a=0;a<s.cols;a++)for(let t=0;t<s.rows;t++)h.push({x:n(a),y:r(t),width:n(1),height:r(1),enabled:!0,onClick:()=>{this.state.takeTurn({x:a,y:t})}});a.Mouse.addClickEventListener(i,...h)}start(){this.backgroundAnimator.draw(),this.gameAnimator.draw(this.state),this.animationFrameId=window.requestAnimationFrame(this.update(0))}ngOnDestroy(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId)}}class k{constructor(){}ngOnInit(){this.scaleCanvas(),this.animator=new b(document.getElementById("game-layer"),document.getElementById("background-layer"),document.getElementById("ui-layer")),this.animator.start()}ngOnDestroy(){this.animator.ngOnDestroy()}scaleCanvas(t){const e=document.getElementById("menu"),i=document.getElementById("main"),s=document.getElementById("stage"),n=document.getElementById("background-layer"),r=(window.innerHeight-e.offsetHeight-10)/n.height,a=i.offsetWidth/n.width,h=Math.min(a,r);Math.max(a,r),s.style.transformOrigin="0 0",s.style.transform="scale("+h+")"}}var p=s.vb({encapsulation:0,styles:[["#stage[_ngcontent-%COMP%]{width:900px;height:900px;position:relative;box-sizing:content-box;border:1px solid;background-color:#fff}#stage[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}#stage[_ngcontent-%COMP%]   #ui-layer[_ngcontent-%COMP%]{z-index:3}#stage[_ngcontent-%COMP%]   #game-layer[_ngcontent-%COMP%]{z-index:2}#stage[_ngcontent-%COMP%]   #background-layer[_ngcontent-%COMP%]{z-index:1}"]],data:{}});function M(t){return s.Tb(0,[(t()(),s.xb(0,0,null,null,3,"div",[["id","stage"]],null,null,null,null,null)),(t()(),s.xb(1,0,null,null,0,"canvas",[["height","900"],["id","ui-layer"],["width","900"]],null,null,null,null,null)),(t()(),s.xb(2,0,null,null,0,"canvas",[["height","900"],["id","game-layer"],["width","900"]],null,null,null,null,null)),(t()(),s.xb(3,0,null,null,0,"canvas",[["height","900"],["id","background-layer"],["width","900"]],null,null,null,null,null))],null,null)}function T(t){return s.Tb(0,[(t()(),s.xb(0,0,null,null,1,"app-tic-tac-toe",[],null,[["window","resize"]],(function(t,e,i){var n=!0;return"window:resize"===e&&(n=!1!==s.Jb(t,1).scaleCanvas(i)&&n),n}),M,p)),s.wb(1,245760,null,0,k,[],null,null)],(function(t,e){t(e,1,0)}),null)}var A=s.tb("app-tic-tac-toe",k,T,{},{},[]),O=i("SVse"),P=i("iInd");class C{}i.d(e,"TicTacToeModuleNgFactory",(function(){return I}));var I=s.ub(n,[],(function(t){return s.Gb([s.Hb(512,s.l,s.fb,[[8,[r.a,A]],[3,s.l],s.B]),s.Hb(4608,O.o,O.n,[s.x,[2,O.D]]),s.Hb(1073742336,O.b,O.b,[]),s.Hb(1073742336,P.o,P.o,[[2,P.t],[2,P.k]]),s.Hb(1073742336,C,C,[]),s.Hb(1073742336,n,n,[]),s.Hb(1024,P.i,(function(){return[[{path:"",component:k}]]}),[])])}))}}]);