(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{jdp0:function(t,e,s){"use strict";s.r(e);var i=s("8Y7J");class n{}var r=s("pMnS"),a=s("UMXM"),h=s("uclk"),o=s("oFjw");const l=.9;let c=(()=>{class t extends h.a{constructor(e,s){super(e,s),this.draw=(e=this.ctx)=>{e.save(),e.fillStyle=t.BACKGROUND_COLOR,e.fillRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=.01*this.canvas.width,e.strokeStyle="rgb(200,200,200)";const s=this.canvas.height*(1-l)/2;for(let t=1;t<this.grid.cols;t++)a.a.drawLine(e,new o.b(this.x(t),this.y(0)*l+s),new o.b(this.x(t),this.y(this.grid.rows)*l+s));const i=this.canvas.width*(1-l)/2;for(let t=1;t<this.grid.cols;t++)a.a.drawLine(e,new o.b(this.x(0)*l+i,this.y(t)),new o.b(this.x(this.grid.rows)*l+i,this.y(t)));e.restore()}}}return t.BACKGROUND_COLOR="#232323",t})();const u=l;class d extends h.a{constructor(t,e){super(t,e),this.draw=(t,e=this.ctx)=>{this.clear(),e.lineWidth=.01*this.canvas.width;for(let s=0;s<t.cols;s++)for(let i=0;i<t.rows;i++)this.drawMarker(t.get({x:s,y:i}))(e,s,i)},this.drawMarker=t=>{switch(t){case"X":return this.drawMarkerX;case"O":return this.drawMarkerO;default:return()=>{}}},this.drawMarkerX=(t,e,s,i="white")=>{t.save();const n=this.x(1),r=this.y(1),h=this.canvas.width*(1-u)/2,l=this.canvas.height*(1-u)/2;t.strokeStyle=i,a.a.drawLine(t,new o.b(this.x(e)+h,this.y(s)+l),new o.b(this.x(e)+n-h,this.y(s)+r-l)),a.a.drawLine(t,new o.b(this.x(e)+h,this.y(s)+r-l),new o.b(this.x(e)+n-h,this.y(s)+l)),t.restore()},this.drawMarkerO=(t,e,s,i="white")=>{t.save();const n=this.x(1),r=this.y(1),a=this.canvas.width*(1-u)/2,h=this.canvas.height*(1-u)/2,o=(Math.min(n,r)*u-Math.min(a,h))/2;t.strokeStyle=i,t.beginPath(),t.arc(this.x(e)+n/2,this.y(s)+r/2,o,0,2*Math.PI),t.stroke(),t.closePath(),t.restore()}}}class w extends h.a{constructor(t,e){super(t,e),this.draw=(t,e=this.ctx)=>{t.winner&&(this.clear(),this.drawText(e,t.winner,t.isAiTurn))},this.drawText=(t,e,s,i=this.canvas.width/2,n=this.canvas.height/2,r=a.a.getFont(this.y(1)),h="rgba(100,100,100,0.9)")=>{t.save(),t.fillStyle=h,t.fillRect(0,this.y(1),this.canvas.width,this.y(1)),a.a.drawText(t,"tie"===e?"tie!":e+" wins!",i,n,this.canvas.width*l,r,"tie"===e?"white":s?"green":"red"),t.restore()}}}const g="X",m="O";class x{constructor(t=3,e=3){this.cols=t,this.rows=e,this.board=[],this.turns=0,this.next=()=>new x(this.cols,this.rows);for(let s=0;s<this.cols;s++)this.board[s]=[]}get({x:t,y:e}){return this.board[t]?this.board[t][e]:void 0}set({x:t,y:e},s){this.board[t][e]=s}setIfAble(t,e){let s=!1;return this.winner||(this.get(e)||(this.set(e,t),s=!0),this.checkWinner()),s}setNextTurn(t){let e=!1;return t&&this.setIfAble(this.getTurn(),t)&&(this.nextTurn(),e=!0),e}takeTurn(t){this.setNextTurn(t)}nextTurn(){return this.turns++%2==0?g:m}getTurn(t=this.turns){return t%2==0?g:m}checkWinner(t=!0){let e;return(e=this.checkColWins())||(e=this.checkRowWins())||(e=this.checkDiagonalWins())||this.checkBoardFull()&&(e="tie"),t&&(this.winner=e),e}checkColWins(){for(let t=0;t<this.cols;t++){let e=this.get({x:t,y:0});for(let s=1;s<this.rows;s++)e!==this.get({x:t,y:s})&&(e=void 0);if(e)return e}}checkRowWins(){for(let t=0;t<this.cols;t++){let e=this.get({x:0,y:t});for(let s=1;s<this.rows;s++)e!==this.get({x:s,y:t})&&(e=void 0);if(e)return e}}checkDiagonalWins(){let t=this.get({x:0,y:0}),e=this.get({x:0,y:this.rows-1});for(let s=1;s<this.cols;s++)t!==this.get({x:s,y:s})&&(t=void 0),e!==this.get({x:s,y:this.rows-1-s})&&(e=void 0);return t||e}checkBoardFull(){for(let t=0;t<this.cols;t++)for(let e=0;e<this.rows;e++)if(!this.get({x:t,y:e}))return!1;return!0}}var b=s("dQPR");const y=t=>{for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t};class f extends x{constructor(t=3,e=3,s=0===Object(b.b)(0)(2)){super(t,e),this.isAiTurn=s,this.next=()=>new f(this.cols,this.rows),this.bestMove=()=>this.minimax().move,this.scores=(t,e=0)=>"tie"===t?0:t===this.getTurn()?10-e:-10+e,this.player=t=>t?this.getTurn():this.getTurn(this.turns+1)}takeTurn(t){if(this.isAiTurn&&!this.checkWinner()){for(;!this.setNextTurn(this.bestMove()););this.checkWinner(),this.isAiTurn=!1}else this.isAiTurn=this.setNextTurn(t)}getAvailableMoves(){const t=[];for(let e=0;e<this.cols;e++)for(let s=0;s<this.rows;s++)this.get({x:e,y:s})||t.push(new o.b(e,s));return t}minimax(t=this,e=0,s=-1/0,i=1/0,n=!0){const r=t.checkWinner(!1);if(void 0!==r)return{score:this.scores(r,e)};const a=y(t.getAvailableMoves());let h,o=n?-1/0:1/0;const l=(t,e)=>n?t>e:t<e;for(const c of a){t.set(c,this.player(n));const{score:r}=this.minimax(t,e+1,s,i,!n);if(t.set(c,void 0),l(r,o)&&(o=r,h=c),n?s=Math.max(s,r):i=Math.min(i,r),i<=s)break}return{score:o,move:h}}}class v{constructor(t,e,s,i=new f){this.state=i,this.fps=60,this.update=t=>e=>{e-t>1e3/this.fps?(this.state.takeTurn(),this.gameAnimator.draw(this.state),this.state.winner?(this.uiAnimator.draw(this.state),this.state=this.state.next(),setTimeout(()=>{this.animationFrameId=window.requestAnimationFrame(this.update(e))},2e3)):(this.uiAnimator.clear(),this.animationFrameId=window.requestAnimationFrame(this.update(e)))):this.animationFrameId=window.requestAnimationFrame(this.update(t))},this.gameAnimator=new d(t,i),this.backgroundAnimator=new c(e,i),this.uiAnimator=new w(s,i);const n=t=>Math.round(t*s.width/this.state.cols),r=t=>Math.round(t*s.height/this.state.rows),h=[];for(let a=0;a<i.cols;a++)for(let t=0;t<i.rows;t++)h.push({x:n(a),y:r(t),width:n(1),height:r(1),enabled:!0,onClick:()=>{this.state.takeTurn({x:a,y:t})}});a.a.addButtonClickEventListener(s,h)}start(){this.backgroundAnimator.draw(),this.gameAnimator.draw(this.state),this.animationFrameId=window.requestAnimationFrame(this.update(0))}ngOnDestroy(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId)}}class k{constructor(){}ngOnInit(){this.scaleCanvas(),this.animator=new v(document.getElementById("game-layer"),document.getElementById("background-layer"),document.getElementById("ui-layer")),this.animator.start()}ngOnDestroy(){this.animator.ngOnDestroy()}scaleCanvas(t){const e=document.getElementById("menu"),s=document.getElementById("main"),i=document.getElementById("stage"),n=document.getElementById("background-layer"),r=(window.innerHeight-e.offsetHeight-10)/n.height,a=s.offsetWidth/n.width,h=Math.min(a,r);Math.max(a,r),i.style.transformOrigin="0 0",i.style.transform="scale("+h+")"}}var p=i.vb({encapsulation:0,styles:[["#stage[_ngcontent-%COMP%]{width:900px;height:900px;position:relative;box-sizing:content-box;border:1px solid;background-color:#fff}#stage[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}#stage[_ngcontent-%COMP%]   #ui-layer[_ngcontent-%COMP%]{z-index:3}#stage[_ngcontent-%COMP%]   #game-layer[_ngcontent-%COMP%]{z-index:2}#stage[_ngcontent-%COMP%]   #background-layer[_ngcontent-%COMP%]{z-index:1}"]],data:{}});function M(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,3,"div",[["id","stage"]],null,null,null,null,null)),(t()(),i.xb(1,0,null,null,0,"canvas",[["height","900"],["id","ui-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(2,0,null,null,0,"canvas",[["height","900"],["id","game-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(3,0,null,null,0,"canvas",[["height","900"],["id","background-layer"],["width","900"]],null,null,null,null,null))],null,null)}function T(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,1,"app-tic-tac-toe",[],null,[["window","resize"]],(function(t,e,s){var n=!0;return"window:resize"===e&&(n=!1!==i.Jb(t,1).scaleCanvas(s)&&n),n}),M,p)),i.wb(1,245760,null,0,k,[],null,null)],(function(t,e){t(e,1,0)}),null)}var O=i.tb("app-tic-tac-toe",k,T,{},{},[]),A=s("SVse"),C=s("iInd");class I{}s.d(e,"TicTacToeModuleNgFactory",(function(){return F}));var F=i.ub(n,[],(function(t){return i.Gb([i.Hb(512,i.l,i.fb,[[8,[r.a,O]],[3,i.l],i.B]),i.Hb(4608,A.o,A.n,[i.x,[2,A.D]]),i.Hb(1073742336,A.b,A.b,[]),i.Hb(1073742336,C.o,C.o,[[2,C.t],[2,C.k]]),i.Hb(1073742336,I,I,[]),i.Hb(1073742336,n,n,[]),i.Hb(1024,C.i,(function(){return[[{path:"",component:k}]]}),[])])}))}}]);