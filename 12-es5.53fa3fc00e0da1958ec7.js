function _defineProperties(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,n,e){return n&&_defineProperties(t.prototype,n),e&&_defineProperties(t,e),t}function _possibleConstructorReturn(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?_assertThisInitialized(t):n}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_setPrototypeOf(t,n)}function _setPrototypeOf(t,n){return(_setPrototypeOf=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{jdp0:function(t,n,e){"use strict";e.r(n);var r,i=e("8Y7J"),a=function t(){_classCallCheck(this,t)},o=e("pMnS"),s=e("UMXM"),u=e("uclk"),l=e("oFjw"),c=.9,h=((r=function(t){function n(t,e){var r;return _classCallCheck(this,n),(r=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,t,e))).draw=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.ctx;t.save(),t.fillStyle=n.BACKGROUND_COLOR,t.fillRect(0,0,r.canvas.width,r.canvas.height),t.lineWidth=.01*r.canvas.width,t.strokeStyle="rgb(200,200,200)";for(var e=r.canvas.height*(1-c)/2,i=1;i<r.grid.cols;i++)s.a.drawLine(t,new l.b(r.x(i),r.y(0)*c+e),new l.b(r.x(i),r.y(r.grid.rows)*c+e));for(var a=r.canvas.width*(1-c)/2,o=1;o<r.grid.cols;o++)s.a.drawLine(t,new l.b(r.x(0)*c+a,r.y(o)),new l.b(r.x(r.grid.rows)*c+a,r.y(o)));t.restore()},r}return _inherits(n,t),n}(u.a)).BACKGROUND_COLOR="#232323",r),f=function(){function t(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;_classCallCheck(this,t),this.cols=e,this.rows=r,this.board=[],this.turns=0,this.next=function(){return new t(n.cols,n.rows)};for(var i=0;i<this.cols;i++)this.board[i]=[]}return _createClass(t,[{key:"get",value:function(t){var n=t.x,e=t.y;return this.board[n]?this.board[n][e]:void 0}},{key:"set",value:function(t,n){var e=t.x,r=t.y;this.board[e][r]=n}},{key:"setIfAble",value:function(t,n){var e=!1;return this.winner||(this.get(n)||(this.set(n,t),e=!0),this.checkWinner()),e}},{key:"setNextTurn",value:function(t){var n=!1;return t&&this.setIfAble(this.getTurn(),t)&&(this.nextTurn(),n=!0),n}},{key:"takeTurn",value:function(t){this.setNextTurn(t)}},{key:"nextTurn",value:function(){return this.turns++%2==0?"X":"O"}},{key:"getTurn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.turns;return t%2==0?"X":"O"}},{key:"checkWinner",value:function(){var t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(t=this.checkColWins())||(t=this.checkRowWins())||(t=this.checkDiagonalWins())||this.checkBoardFull()&&(t="tie"),n&&(this.winner=t),t}},{key:"checkColWins",value:function(){for(var t=0;t<this.cols;t++){for(var n=this.get({x:t,y:0}),e=1;e<this.rows;e++)n!==this.get({x:t,y:e})&&(n=void 0);if(n)return n}}},{key:"checkRowWins",value:function(){for(var t=0;t<this.cols;t++){for(var n=this.get({x:0,y:t}),e=1;e<this.rows;e++)n!==this.get({x:e,y:t})&&(n=void 0);if(n)return n}}},{key:"checkDiagonalWins",value:function(){for(var t=this.get({x:0,y:0}),n=this.get({x:0,y:this.rows-1}),e=1;e<this.cols;e++)t!==this.get({x:e,y:e})&&(t=void 0),n!==this.get({x:e,y:this.rows-1-e})&&(n=void 0);return t||n}},{key:"checkBoardFull",value:function(){for(var t=0;t<this.cols;t++)for(var n=0;n<this.rows;n++)if(!this.get({x:t,y:n}))return!1;return!0}}]),t}(),d=e("dQPR"),v=function(t){for(var n=t.length-1;n>0;n--){var e=Math.floor(Math.random()*(n+1)),r=[t[e],t[n]];t[n]=r[0],t[e]=r[1]}return t},g=function(t){function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(d.b)(0)(2);return _classCallCheck(this,n),(t=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,e,r))).aiPlayer=i,t.next=function(){return new n(t.cols,t.rows)},t.bestMove=function(){return t.minimax().move},t.scores=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"tie"===n?0:n===t.getTurn()?10-e:-10+e},t.player=function(n){return n?t.getTurn():t.getTurn(t.turns+1)},t.isAiTurn=function(){return t.turns%2===t.aiPlayer},t}return _inherits(n,t),_createClass(n,[{key:"takeTurn",value:function(t){if(this.isAiTurn()&&!this.checkWinner()){for(;!this.setNextTurn(this.bestMove()););this.checkWinner()}else this.setNextTurn(t)}},{key:"getAvailableMoves",value:function(){for(var t=[],n=0;n<this.cols;n++)for(var e=0;e<this.rows;e++)this.get({x:n,y:e})||t.push(new l.b(n,e));return t}},{key:"minimax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1/0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=t.checkWinner(!1);if(void 0!==a)return{score:this.scores(a,n)};var o,s=v(t.getAvailableMoves()),u=i?-1/0:1/0,l=function(t,n){return i?t>n:t<n},c=!0,h=!1,f=void 0;try{for(var d,g=s[Symbol.iterator]();!(c=(d=g.next()).done);c=!0){var y=d.value;t.set(y,this.player(i));var w=this.minimax(t,n+1,e,r,!i),b=w.score;if(t.set(y,void 0),l(b,u)&&(u=b,o=y),i?e=Math.max(e,b):r=Math.min(r,b),r<=e)break}}catch(m){h=!0,f=m}finally{try{c||null==g.return||g.return()}finally{if(h)throw f}}return{score:u,move:o}}}]),n}(f),y=c,w=function(t){return"human"===t?"#33ff33":"ai"===t?"#ff3333":"white"},b=function(t){return t instanceof g?function(n){return n===(t.aiPlayer?"O":"X")?"ai":"human"}:function(){}},m=function(t){function n(t,e){var r;return _classCallCheck(this,n),(r=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,t,e))).draw=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ctx;r.clear();var e=b(t);n.lineWidth=.01*r.canvas.width;for(var i=0;i<t.cols;i++)for(var a=0;a<t.rows;a++){var o=t.get({x:i,y:a});r.drawMarker(o,e(o))(n,i,a)}},r.drawMarker=function(t,n){switch(t){case"X":return r.drawMarkerX(n);case"O":return r.drawMarkerO(n);default:return function(){}}},r.drawMarkerX=function(t){return function(n,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w(t);n.save();var o=r.x(1),u=r.y(1),c=r.canvas.width*(1-y)/2,h=r.canvas.height*(1-y)/2;n.strokeStyle=a,s.a.drawLine(n,new l.b(r.x(e)+c,r.y(i)+h),new l.b(r.x(e)+o-c,r.y(i)+u-h)),s.a.drawLine(n,new l.b(r.x(e)+c,r.y(i)+u-h),new l.b(r.x(e)+o-c,r.y(i)+h)),n.restore()}},r.drawMarkerO=function(t){return function(n,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w(t);n.save();var o=r.x(1),s=r.y(1),u=r.canvas.width*(1-y)/2,l=r.canvas.height*(1-y)/2,c=(Math.min(o,s)*y-Math.min(u,l))/2;n.strokeStyle=a,n.beginPath(),n.arc(r.x(e)+o/2,r.y(i)+s/2,c,0,2*Math.PI),n.stroke(),n.closePath(),n.restore()}},r}return _inherits(n,t),n}(u.a),k=function(t){function n(t,e){var r;return _classCallCheck(this,n),(r=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,t,e))).draw=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ctx;t.winner&&(r.clear(),r.drawText(n,t.winner,t.isAiTurn()?"human":"ai"))},r.drawText=function(t,n,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.canvas.width/2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.canvas.height/2,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s.a.getFont(r.y(1)),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"rgba(100,100,100,0.95)",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:w("tie"===n?"tie":e);t.save(),t.fillStyle=u,t.fillRect(0,r.y(1),r.canvas.width,r.y(1)),s.a.drawText(t,"tie"===n?"tie!":n+" wins!",i,a,r.canvas.width*c,o,l),t.restore()},r}return _inherits(n,t),n}(u.a),p=function(){function t(n,e,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new g;_classCallCheck(this,t),this.state=a,this.fps=60,this.update=function(t){return function(n){n-t>1e3/i.fps?(i.state.takeTurn(),i.gameAnimator.draw(i.state),i.state.winner?(i.uiAnimator.draw(i.state),i.state=i.state.next(),setTimeout((function(){i.animationFrameId=window.requestAnimationFrame(i.update(n))}),2e3)):(i.uiAnimator.clear(),i.animationFrameId=window.requestAnimationFrame(i.update(n)))):i.animationFrameId=window.requestAnimationFrame(i.update(t))}},this.gameAnimator=new m(n,a),this.backgroundAnimator=new h(e,a),this.uiAnimator=new k(r,a);for(var o=function(t){return Math.round(t*r.width/i.state.cols)},u=function(t){return Math.round(t*r.height/i.state.rows)},l=[],c=function(t){for(var n=function(n){l.push({x:o(t),y:u(n),width:o(1),height:u(1),enabled:!0,onClick:function(){i.state.takeTurn({x:t,y:n})}})},e=0;e<a.rows;e++)n(e)},f=0;f<a.cols;f++)c(f);s.a.addButtonClickEventListener(r,l)}return _createClass(t,[{key:"start",value:function(){this.backgroundAnimator.draw(),this.gameAnimator.draw(this.state),this.animationFrameId=window.requestAnimationFrame(this.update(0))}},{key:"ngOnDestroy",value:function(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId)}}]),t}(),x=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){this.scaleCanvas(),this.animator=new p(document.getElementById("game-layer"),document.getElementById("background-layer"),document.getElementById("ui-layer")),this.animator.start()}},{key:"ngOnDestroy",value:function(){this.animator.ngOnDestroy()}},{key:"scaleCanvas",value:function(t){var n=document.getElementById("menu"),e=document.getElementById("main"),r=document.getElementById("stage"),i=document.getElementById("background-layer"),a=(window.innerHeight-n.offsetHeight-10)/i.height,o=e.offsetWidth/i.width,s=Math.min(o,a);Math.max(o,a),r.style.transformOrigin="0 0",r.style.transform="scale("+s+")"}}]),t}(),_=i.vb({encapsulation:0,styles:[["#stage[_ngcontent-%COMP%]{width:900px;height:900px;position:relative;box-sizing:content-box;border:1px solid;background-color:#fff}#stage[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}#stage[_ngcontent-%COMP%]   #ui-layer[_ngcontent-%COMP%]{z-index:3}#stage[_ngcontent-%COMP%]   #game-layer[_ngcontent-%COMP%]{z-index:2}#stage[_ngcontent-%COMP%]   #background-layer[_ngcontent-%COMP%]{z-index:1}"]],data:{}});function C(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,3,"div",[["id","stage"]],null,null,null,null,null)),(t()(),i.xb(1,0,null,null,0,"canvas",[["height","900"],["id","ui-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(2,0,null,null,0,"canvas",[["height","900"],["id","game-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(3,0,null,null,0,"canvas",[["height","900"],["id","background-layer"],["width","900"]],null,null,null,null,null))],null,null)}var O=i.tb("app-tic-tac-toe",x,(function(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,1,"app-tic-tac-toe",[],null,[["window","resize"]],(function(t,n,e){var r=!0;return"window:resize"===n&&(r=!1!==i.Jb(t,1).scaleCanvas(e)&&r),r}),C,_)),i.wb(1,245760,null,0,x,[],null,null)],(function(t,n){t(n,1,0)}),null)}),{},{},[]),M=e("SVse"),P=e("iInd"),T=function t(){_classCallCheck(this,t)};e.d(n,"TicTacToeModuleNgFactory",(function(){return A}));var A=i.ub(a,[],(function(t){return i.Gb([i.Hb(512,i.l,i.fb,[[8,[o.a,O]],[3,i.l],i.B]),i.Hb(4608,M.o,M.n,[i.x,[2,M.D]]),i.Hb(1073742336,M.b,M.b,[]),i.Hb(1073742336,P.o,P.o,[[2,P.t],[2,P.k]]),i.Hb(1073742336,T,T,[]),i.Hb(1073742336,a,a,[]),i.Hb(1024,P.i,(function(){return[[{path:"",component:x}]]}),[])])}))}}]);