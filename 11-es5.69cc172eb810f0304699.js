function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{ElCL:function(e,t,n){"use strict";n.r(t);var s,i,a,r,o,u=n("8Y7J"),l=function e(){_classCallCheck(this,e)},h=n("pMnS"),c=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"setCookie",value:function(e,t,n){var s=new Date;s.setTime(s.getTime()+24*n*60*60*1e3);var i="expires="+s.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"}},{key:"getCookie",value:function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),s=0;s<n.length;s++){for(var i=n[s];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""}}]),e}(),f=n("oFjw"),d=n("dQPR"),v=function(){function e(t,n,s,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];_classCallCheck(this,e),this.cols=t,this.rows=n,this.moves=s,this.start=i,this.snake=a}return _createClass(e,[{key:"willEat",value:function(e){return this.nextHead().equals(e)}},{key:"inSnake",value:function(e){return this.snake.some((function(t){return t.equals(e)}))}},{key:"willCrash",value:function(e){var t=this.nextHead();return this.inSnake(t)||e&&(e.inSnake(t)||this.snake[0]&&this.snake[0].equals(e.snake[0]))}},{key:"validMove",value:function(e){return this.moves[0].x+e.x!==0||this.moves[0].y+e.y!==0}},{key:"nextMoves",value:function(){return this.moves.length>1?this.moves.slice(1):this.moves}},{key:"nextHead",value:function(){return 0===this.snake.length?this.start:new f.b(Object(d.a)(this.cols)(this.snake[0].x+this.moves[0].x),Object(d.a)(this.rows)(this.snake[0].y+this.moves[0].y))}},{key:"nextSnake",value:function(e,t){var n=this;return this.willCrash(t)?[]:e.some((function(e){return n.willEat(e)}))?[this.nextHead()].concat(this.snake):[this.nextHead()].concat(this.snake.slice(0,this.snake.length-1))}},{key:"merge",value:function(t){return Object.assign(new e(this.cols,this.rows,this.moves,this.start,this.snake),t)}},{key:"next",value:function(t,n,s,i){return new e(t,n,this.nextMoves(),this.start,this.nextSnake(s,i))}},{key:"enqueue",value:function(e){return this.validMove(e)?this.merge({moves:this.moves.concat([e])}):this}},{key:"direction",value:function(){var e=this.moves[0];return e.equals(f.a.NORTH)?270:e.equals(f.a.SOUTH)?90:e.equals(f.a.EAST)?0:e.equals(f.a.WEST)?180:null}},{key:"segments",value:function(){return this.snake.reduce((function(e,t){if(0===e.length)e.push([t]);else{var n=e[e.length-1];1===t.distance(n[n.length-1])?n.push(t):e.push([t])}return e}),[])}},{key:"isAlive",value:function(){return this.snake.length>0}}]),e}(),y=((s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:24,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[new f.b(20,2),new f.b(2,20)];_classCallCheck(this,e),this.isTwoPlayers=t,this.cols=n,this.rows=s,this.snakes=i,this.apples=a,0===this.snakes.length&&(this.snakes=[this.snakeFromState(f.a.EAST,new f.b(2,2))],this.isTwoPlayers&&this.snakes.push(this.snakeFromState(f.a.NORTH,new f.b(20,20))))}return _createClass(e,[{key:"snakeFromState",value:function(e,t){return new v(this.cols,this.rows,[e],t,[t])}},{key:"isCrash",value:function(){return this.snakes.reduce((function(e,t){return e||!t.isAlive()}),!1)}},{key:"willEat",value:function(e){return this.snakes.reduce((function(t,n){return t||n.willEat(e)}),!1)}},{key:"newApple",value:function(){var e;do{e=this.snakes.reduce((function(e,t){return t.inSnake(e)?null:e}),this.rndPos())}while(!e);return e}},{key:"nextApple",value:function(e){return this.willEat(e)?this.apples.length<=1||0===Object(d.b)(0)(2)?this.newApple():null:e}},{key:"nextApples",value:function(){var t=this,n=this.apples.map((function(e){return t.nextApple(e)})).filter(Boolean);return this.apples.length<e.MAX_APPLES&&0===Object(d.b)(0)(100)&&n.push(this.newApple()),n}},{key:"nextSnakes",value:function(){var e=this;return this.snakes.map((function(t,n,s){return t.next(e.cols,e.rows,e.apples,s.length>1?s[(n+1)%s.length]:null)}))}},{key:"rndPos",value:function(){return new f.b(Object(d.b)(0)(this.cols),Object(d.b)(0)(this.rows))}},{key:"merge",value:function(t){return Object.assign(new e,this,t)}},{key:"next",value:function(){return new e(this.isTwoPlayers,this.cols,this.rows,this.nextSnakes(),this.nextApples())}},{key:"enqueue",value:function(e,t){var n=this;return e%=this.snakes.length,this.merge({snakes:this.snakes.map((function(s,i){return i===e?n.snakes[e].enqueue(t):s}))})}}]),e}()).MAX_APPLES=5,s),g=n("uclk"),k=((i=function(e){function t(e,n){var s;return _classCallCheck(this,t),(s=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).draw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.ctx;e.save(),e.fillStyle=t.BACKGROUND_COLOR,e.fillRect(0,0,s.canvas.width,s.canvas.height),e.restore()},s}return _inherits(t,e),t}(g.a)).BACKGROUND_COLOR="#232323",i),p=n("UMXM"),w=function(e){function t(e,n,s,i){var a;_classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).buttons=[],a.eventListeners=[],a.draw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.ctx;a.clear(),e.save(),a.buttons.forEach(p.a.drawButton(e)),e.restore()};var r=e.width/4,o=e.height/8,u=e.width/2-r/2,l=e.height/2-o/2;return a.buttons.push({x:u,y:l,width:r,height:o,radius:5,fillStyle:"#005FA1",hoverStyle:"#00487b",text:"Paused",font:p.a.getFont(a.y(1)),textStyle:"white",enabled:!0,onClick:function(){s()}},{x:u,y:l+2*o,width:r,height:o,radius:5,fillStyle:"#005fa1",hoverStyle:"#00487b",text:"Two Players",font:p.a.getFont(.8*a.y(1)),textStyle:"rgba(255, 255, 255, 1)",enabled:!0,onClick:function(){i()}}),a.addEventListeners(),a}return _inherits(t,e),_createClass(t,[{key:"addEventListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.canvas,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.buttons;return this.eventListeners.push(p.a.addButtonClickEventListener(e,t),p.a.addButtonHoverEventListener(e,t))}},{key:"removeEventListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.canvas,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.eventListeners;t.forEach((function(t){e.removeEventListener(t.type,t.function)}))}},{key:"enableButtons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.buttons;e.forEach((function(e){return e.enabled=!0}))}},{key:"disableButtons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.buttons;e.forEach((function(e){return e.enabled=!1}))}},{key:"show",value:function(){this.enableButtons(),this.draw()}},{key:"hide",value:function(){this.clear(),this.disableButtons(),this.canvas.style.cursor="default"}},{key:"ngOnDestroy",value:function(){this.removeEventListeners()}}]),t}(g.a),m=((r=function(e){function t(e,n){var s;return _classCallCheck(this,t),(s=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).draw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.ctx;return function(n){e.save(),n.snakes.forEach((function(n,i){n.isAlive()&&(e.strokeStyle=t.SNAKE_COLORS[i],s.drawSnake(e,n))})),e.restore()}},s.drawSnakeSegment=function(e){return function(t){e.save(),e.lineWidth=Math.min(s.x(1),s.y(1)),e.lineCap="round",e.lineJoin="round";var n=t.shift();e.moveTo(s.x(n.x)+s.x(1)/2,s.y(n.y)+s.y(1)/2),e.beginPath(),e.lineTo(s.x(n.x)+s.x(1)/2,s.y(n.y)+s.y(1)/2),t.forEach((function(t){e.lineTo(s.x(t.x)+s.x(1)/2,s.y(t.y)+s.y(1)/2)})),e.stroke(),e.restore()}},s}return _inherits(t,e),_createClass(t,[{key:"drawSnake",value:function(e,t){t.segments().forEach(this.drawSnakeSegment(e)),this.drawSnakeHead(e,t)}},{key:"drawSnakeHead",value:function(e,t){e.save();var n=t.snake[0];e.translate(this.x(n.x)+this.x(1)/2,this.y(n.y)+this.y(1)/2),e.rotate(Math.PI/180*t.direction());var s=0+3*this.x(1)/16,i=3*this.y(1)/16;e.fillStyle="white";var a=Math.min(this.x(1),this.y(1))/8;e.beginPath(),e.arc(s,0-i,a,0,2*Math.PI),e.arc(s,0+i,a,0,2*Math.PI),e.fill(),e.fillStyle="black",a/=2,e.beginPath(),e.arc(s+a,0-i,a,0,2*Math.PI),e.arc(s+a,0+i,a,0,2*Math.PI),e.fill(),e.restore()}}]),t}(g.a)).SNAKE_COLORS=["#00c832","#c7c700"],r),b=((a=function(e){function t(e,n){var s;return _classCallCheck(this,t),(s=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).draw=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.ctx;s.clear(),s.snakeAnimator.draw()(e),s.drawApple(t)(e),e.isCrash()&&s.drawCrash(t)},s.drawApple=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.ctx;return function(n){e.save(),e.fillStyle=t.APPLE_COLOR,n.apples.forEach((function(t){p.a.drawRoundedRect(e,s.x(t.x),s.y(t.y),s.x(1),s.y(1))})),e.restore()}},s.snakeAnimator=new m(e,n),s}return _inherits(t,e),_createClass(t,[{key:"drawCrash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.ctx;e.fillStyle=t.CRASH_COLOR,e.fillRect(0,0,this.canvas.width,this.canvas.height)}}]),t}(g.a)).APPLE_COLOR="#ff3200",a.CRASH_COLOR="rgb(255,0,0)",a),_=function(){function e(t,n,s){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new y(!0);_classCallCheck(this,e),this.state=a,this.fps=10,this.paused=!1,this.update=function(e){return function(t){t-e>1e3/i.fps?(i.paused?i.pauseMenuAnimator.draw():(i.state=i.state.next(),i.gameAnimator.draw(i.state)),i.animationFrameId=window.requestAnimationFrame(i.update(t))):i.animationFrameId=window.requestAnimationFrame(i.update(e))}},this.gameAnimator=new b(t,a),this.pauseMenuAnimator=new w(s,a,(function(){return i.pause()}),(function(){return i.toggleTwoPlayers()})),this.backgroundAnimator=new k(n,a)}return _createClass(e,[{key:"start",value:function(){this.backgroundAnimator.draw(),this.gameAnimator.draw(this.state),this.pause(),this.animationFrameId=window.requestAnimationFrame(this.update(0))}},{key:"ngOnDestroy",value:function(){this.animationFrameId&&(window.cancelAnimationFrame(this.animationFrameId),this.pauseMenuAnimator.ngOnDestroy())}},{key:"keyEvent",value:function(e){switch(e){case" ":return this.pause(),!0;case"w":return this.state=this.state.enqueue(0,f.a.NORTH),!0;case"a":return this.state=this.state.enqueue(0,f.a.WEST),!0;case"s":return this.state=this.state.enqueue(0,f.a.SOUTH),!0;case"d":return this.state=this.state.enqueue(0,f.a.EAST),!0;case"i":case"ArrowUp":return this.state=this.state.enqueue(1,f.a.NORTH),!0;case"j":case"ArrowLeft":return this.state=this.state.enqueue(1,f.a.WEST),!0;case"k":case"ArrowDown":return this.state=this.state.enqueue(1,f.a.SOUTH),!0;case"l":case"ArrowRight":return this.state=this.state.enqueue(1,f.a.EAST),!0}return!1}},{key:"pause",value:function(){(this.paused=!this.paused)?this.pauseMenuAnimator.show():this.pauseMenuAnimator.hide()}},{key:"toggleTwoPlayers",value:function(){this.gameAnimator.draw(this.state=new y(!this.state.isTwoPlayers))}}]),e}(),C=((o=function(){function e(){_classCallCheck(this,e),this._highScore=0}return _createClass(e,[{key:"ngOnInit",value:function(){var t=this;this.scaleCanvas(),this.animator=new _(document.getElementById("game-layer"),document.getElementById("background-layer"),document.getElementById("ui-layer")),window.addEventListener("keydown",(function(e){t.animator.keyEvent(e.key)&&e.preventDefault()})),this.animator.start(),this.highScore=+c.getCookie(e.COOKIE_NAME)}},{key:"ngOnDestroy",value:function(){this.animator.ngOnDestroy()}},{key:"scaleCanvas",value:function(e){var t=document.getElementById("menu"),n=document.getElementById("main"),s=document.getElementById("stage"),i=document.getElementById("background-layer"),a=(window.innerHeight-t.offsetHeight-10)/i.height,r=n.offsetWidth/i.width,o=Math.min(r,a);Math.max(r,a),s.style.transformOrigin="0 0",s.style.transform="scale("+o+")"}},{key:"score",get:function(){return Math.max.apply(Math,_toConsumableArray(this.animator.state.snakes.map((function(e){return e.snake.length}))))},set:function(e){}},{key:"highScore",get:function(){return this.score>this._highScore&&(this._highScore=this.score,c.setCookie(e.COOKIE_NAME,this._highScore,90)),this._highScore},set:function(e){this._highScore=e}}]),e}()).COOKIE_NAME="snake-high-score",o),O=u.vb({encapsulation:0,styles:[["#stage[_ngcontent-%COMP%]{width:900px;height:900px;position:relative;box-sizing:content-box;border:1px solid;background-color:#fff}#stage[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}#stage[_ngcontent-%COMP%]   #ui-layer[_ngcontent-%COMP%]{z-index:3}#stage[_ngcontent-%COMP%]   #game-layer[_ngcontent-%COMP%]{z-index:2}#stage[_ngcontent-%COMP%]   #background-layer[_ngcontent-%COMP%]{z-index:1}"]],data:{}});function x(e){return u.Tb(0,[(e()(),u.xb(0,0,null,null,3,"div",[["id","stage"]],null,null,null,null,null)),(e()(),u.xb(1,0,null,null,0,"canvas",[["height","900"],["id","ui-layer"],["width","900"]],null,null,null,null,null)),(e()(),u.xb(2,0,null,null,0,"canvas",[["height","900"],["id","game-layer"],["width","900"]],null,null,null,null,null)),(e()(),u.xb(3,0,null,null,0,"canvas",[["height","900"],["id","background-layer"],["width","900"]],null,null,null,null,null))],null,null)}var S=u.tb("app-snake",C,(function(e){return u.Tb(0,[(e()(),u.xb(0,0,null,null,1,"app-snake",[],null,[["window","resize"]],(function(e,t,n){var s=!0;return"window:resize"===t&&(s=!1!==u.Jb(e,1).scaleCanvas(n)&&s),s}),x,O)),u.wb(1,245760,null,0,C,[],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),A=n("SVse"),E=n("s7LF"),P=n("iInd"),M=function e(){_classCallCheck(this,e)};n.d(t,"SnakeModuleNgFactory",(function(){return T}));var T=u.ub(l,[],(function(e){return u.Gb([u.Hb(512,u.l,u.fb,[[8,[h.a,S]],[3,u.l],u.B]),u.Hb(4608,A.o,A.n,[u.x,[2,A.D]]),u.Hb(4608,E.o,E.o,[]),u.Hb(1073742336,A.b,A.b,[]),u.Hb(1073742336,P.o,P.o,[[2,P.t],[2,P.k]]),u.Hb(1073742336,M,M,[]),u.Hb(1073742336,E.n,E.n,[]),u.Hb(1073742336,E.d,E.d,[]),u.Hb(1073742336,l,l,[]),u.Hb(1024,P.i,(function(){return[[{path:"",component:C}]]}),[])])}))}}]);