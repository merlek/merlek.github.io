(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{jdp0:function(t,s,e){"use strict";e.r(s);var i=e("8Y7J");class n{}var r=e("pMnS"),a=e("UMXM"),h=e("uclk"),o=e("oFjw");const l=.9;let c=(()=>{class t extends h.a{constructor(s,e){super(s,e),this.draw=(s=this.ctx)=>{s.save(),s.fillStyle=t.BACKGROUND_COLOR,s.fillRect(0,0,this.canvas.width,this.canvas.height),s.lineWidth=.01*this.canvas.width,s.strokeStyle="rgb(200,200,200)";const e=this.canvas.height*(1-l)/2;for(let t=1;t<this.grid.cols;t++)a.a.drawLine(s,new o.b(this.x(t),this.y(0)*l+e),new o.b(this.x(t),this.y(this.grid.rows)*l+e));const i=this.canvas.width*(1-l)/2;for(let t=1;t<this.grid.cols;t++)a.a.drawLine(s,new o.b(this.x(0)*l+i,this.y(t)),new o.b(this.x(this.grid.rows)*l+i,this.y(t)));s.restore()}}}return t.BACKGROUND_COLOR="#232323",t})();const u="X",d="O";class w{constructor(t=3,s=3){this.cols=t,this.rows=s,this.board=[],this.turns=0,this.next=()=>new w(this.cols,this.rows);for(let e=0;e<this.cols;e++)this.board[e]=[]}get({x:t,y:s}){return this.board[t]?this.board[t][s]:void 0}set({x:t,y:s},e){this.board[t][s]=e}setIfAble(t,s){let e=!1;return this.winner||(this.get(s)||(this.set(s,t),e=!0),this.checkWinner()),e}setNextTurn(t){let s=!1;return t&&this.setIfAble(this.getTurn(),t)&&(this.nextTurn(),s=!0),s}takeTurn(t){this.setNextTurn(t)}nextTurn(){return this.turns++%2==0?u:d}getTurn(t=this.turns){return t%2==0?u:d}checkWinner(t=!0){let s;return(s=this.checkColWins())||(s=this.checkRowWins())||(s=this.checkDiagonalWins())||this.checkBoardFull()&&(s="tie"),t&&(this.winner=s),s}checkColWins(){for(let t=0;t<this.cols;t++){let s=this.get({x:t,y:0});for(let e=1;e<this.rows;e++)s!==this.get({x:t,y:e})&&(s=void 0);if(s)return s}}checkRowWins(){for(let t=0;t<this.cols;t++){let s=this.get({x:0,y:t});for(let e=1;e<this.rows;e++)s!==this.get({x:e,y:t})&&(s=void 0);if(s)return s}}checkDiagonalWins(){let t=this.get({x:0,y:0}),s=this.get({x:0,y:this.rows-1});for(let e=1;e<this.cols;e++)t!==this.get({x:e,y:e})&&(t=void 0),s!==this.get({x:e,y:this.rows-1-e})&&(s=void 0);return t||s}checkBoardFull(){for(let t=0;t<this.cols;t++)for(let s=0;s<this.rows;s++)if(!this.get({x:t,y:s}))return!1;return!0}}var g=e("dQPR");const m=t=>{for(let s=t.length-1;s>0;s--){const e=Math.floor(Math.random()*(s+1));[t[s],t[e]]=[t[e],t[s]]}return t};class x extends w{constructor(t=3,s=3,e=Object(g.b)(0)(2)){super(t,s),this.aiPlayer=e,this.next=()=>new x(this.cols,this.rows),this.bestMove=()=>this.minimax().move,this.scores=(t,s=0)=>"tie"===t?0:t===this.getTurn()?10-s:-10+s,this.player=t=>t?this.getTurn():this.getTurn(this.turns+1),this.isAiTurn=()=>this.turns%2===this.aiPlayer}takeTurn(t){if(this.isAiTurn()&&!this.checkWinner()){for(;!this.setNextTurn(this.bestMove()););this.checkWinner()}else this.setNextTurn(t)}getAvailableMoves(){const t=[];for(let s=0;s<this.cols;s++)for(let e=0;e<this.rows;e++)this.get({x:s,y:e})||t.push(new o.b(s,e));return t}minimax(t=this,s=0,e=-1/0,i=1/0,n=!0){const r=t.checkWinner(!1);if(void 0!==r)return{score:this.scores(r,s)};const a=m(t.getAvailableMoves());let h,o=n?-1/0:1/0;const l=(t,s)=>n?t>s:t<s;for(const c of a){t.set(c,this.player(n));const{score:r}=this.minimax(t,s+1,e,i,!n);if(t.set(c,void 0),l(r,o)&&(o=r,h=c),n?e=Math.max(e,r):i=Math.min(i,r),i<=e)break}return{score:o,move:h}}}const b=l,y=t=>"human"===t?"#33ff33":"ai"===t?"#ff3333":"white",f=t=>t instanceof x?s=>s===(t.aiPlayer?"O":"X")?"ai":"human":()=>void 0;class v extends h.a{constructor(t,s){super(t,s),this.draw=(t,s=this.ctx)=>{this.clear();const e=f(t);s.lineWidth=.01*this.canvas.width;for(let i=0;i<t.cols;i++)for(let n=0;n<t.rows;n++){const r=t.get({x:i,y:n});this.drawMarker(r,e(r))(s,i,n)}},this.drawMarker=(t,s)=>{switch(t){case"X":return this.drawMarkerX(s);case"O":return this.drawMarkerO(s);default:return()=>{}}},this.drawMarkerX=t=>(s,e,i,n=y(t))=>{s.save();const r=this.x(1),h=this.y(1),l=this.canvas.width*(1-b)/2,c=this.canvas.height*(1-b)/2;s.strokeStyle=n,a.a.drawLine(s,new o.b(this.x(e)+l,this.y(i)+c),new o.b(this.x(e)+r-l,this.y(i)+h-c)),a.a.drawLine(s,new o.b(this.x(e)+l,this.y(i)+h-c),new o.b(this.x(e)+r-l,this.y(i)+c)),s.restore()},this.drawMarkerO=t=>(s,e,i,n=y(t))=>{s.save();const r=this.x(1),a=this.y(1),h=this.canvas.width*(1-b)/2,o=this.canvas.height*(1-b)/2,l=(Math.min(r,a)*b-Math.min(h,o))/2;s.strokeStyle=n,s.beginPath(),s.arc(this.x(e)+r/2,this.y(i)+a/2,l,0,2*Math.PI),s.stroke(),s.closePath(),s.restore()}}}class k extends h.a{constructor(t,s){super(t,s),this.draw=(t,s=this.ctx)=>{t.winner&&(this.clear(),this.drawText(s,t.winner,t.isAiTurn()?"human":"ai"))},this.drawText=(t,s,e,i=this.canvas.width/2,n=this.canvas.height/2,r=a.a.getFont(this.y(1)),h="rgba(100,100,100,0.95)",o=y("tie"===s?"tie":e))=>{t.save(),t.fillStyle=h,t.fillRect(0,this.y(1),this.canvas.width,this.y(1)),a.a.drawText(t,"tie"===s?"tie!":s+" wins!",i,n,this.canvas.width*l,r,o),t.restore()}}}class p{constructor(t,s,e,i=new x){this.state=i,this.fps=60,this.update=t=>s=>{s-t>1e3/this.fps?(this.state.takeTurn(),this.gameAnimator.draw(this.state),this.state.winner?(this.uiAnimator.draw(this.state),this.state=this.state.next(),setTimeout(()=>{this.animationFrameId=window.requestAnimationFrame(this.update(s))},2e3)):(this.uiAnimator.clear(),this.animationFrameId=window.requestAnimationFrame(this.update(s)))):this.animationFrameId=window.requestAnimationFrame(this.update(t))},this.gameAnimator=new v(t,i),this.backgroundAnimator=new c(s,i),this.uiAnimator=new k(e,i);const n=t=>Math.round(t*e.width/this.state.cols),r=t=>Math.round(t*e.height/this.state.rows),h=[];for(let a=0;a<i.cols;a++)for(let t=0;t<i.rows;t++)h.push({x:n(a),y:r(t),width:n(1),height:r(1),enabled:!0,onClick:()=>{this.state.takeTurn({x:a,y:t})}});a.a.addButtonClickEventListener(e,h)}start(){this.backgroundAnimator.draw(),this.gameAnimator.draw(this.state),this.animationFrameId=window.requestAnimationFrame(this.update(0))}ngOnDestroy(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId)}}class M{constructor(){}ngOnInit(){this.scaleCanvas(),this.animator=new p(document.getElementById("game-layer"),document.getElementById("background-layer"),document.getElementById("ui-layer")),this.animator.start()}ngOnDestroy(){this.animator.ngOnDestroy()}scaleCanvas(t){const s=document.getElementById("menu"),e=document.getElementById("main"),i=document.getElementById("stage"),n=document.getElementById("background-layer"),r=(window.innerHeight-s.offsetHeight-10)/n.height,a=e.offsetWidth/n.width,h=Math.min(a,r);Math.max(a,r),i.style.transformOrigin="0 0",i.style.transform="scale("+h+")"}}var T=i.vb({encapsulation:0,styles:[["#stage[_ngcontent-%COMP%]{width:900px;height:900px;position:relative;box-sizing:content-box;border:1px solid;background-color:#fff}#stage[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}#stage[_ngcontent-%COMP%]   #ui-layer[_ngcontent-%COMP%]{z-index:3}#stage[_ngcontent-%COMP%]   #game-layer[_ngcontent-%COMP%]{z-index:2}#stage[_ngcontent-%COMP%]   #background-layer[_ngcontent-%COMP%]{z-index:1}"]],data:{}});function O(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,3,"div",[["id","stage"]],null,null,null,null,null)),(t()(),i.xb(1,0,null,null,0,"canvas",[["height","900"],["id","ui-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(2,0,null,null,0,"canvas",[["height","900"],["id","game-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(3,0,null,null,0,"canvas",[["height","900"],["id","background-layer"],["width","900"]],null,null,null,null,null))],null,null)}function A(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,1,"app-tic-tac-toe",[],null,[["window","resize"]],(function(t,s,e){var n=!0;return"window:resize"===s&&(n=!1!==i.Jb(t,1).scaleCanvas(e)&&n),n}),O,T)),i.wb(1,245760,null,0,M,[],null,null)],(function(t,s){t(s,1,0)}),null)}var C=i.tb("app-tic-tac-toe",M,A,{},{},[]),I=e("SVse"),F=e("iInd");class P{}e.d(s,"TicTacToeModuleNgFactory",(function(){return W}));var W=i.ub(n,[],(function(t){return i.Gb([i.Hb(512,i.l,i.fb,[[8,[r.a,C]],[3,i.l],i.B]),i.Hb(4608,I.o,I.n,[i.x,[2,I.D]]),i.Hb(1073742336,I.b,I.b,[]),i.Hb(1073742336,F.o,F.o,[[2,F.t],[2,F.k]]),i.Hb(1073742336,P,P,[]),i.Hb(1073742336,n,n,[]),i.Hb(1024,F.i,(function(){return[[{path:"",component:M}]]}),[])])}))}}]);