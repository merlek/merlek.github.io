function _possibleConstructorReturn(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?_assertThisInitialized(t):n}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_setPrototypeOf(t,n)}function _setPrototypeOf(t,n){return(_setPrototypeOf=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _defineProperties(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,n,e){return n&&_defineProperties(t.prototype,n),e&&_defineProperties(t,e),t}function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{jdp0:function(t,n,e){"use strict";e.r(n);var r,i=e("8Y7J"),a=function t(){_classCallCheck(this,t)},o=e("pMnS"),s=e("26NK"),u=function(){function t(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;_classCallCheck(this,t),this.cols=e,this.rows=r,this.board=[],this.turns=0,this.next=function(){return new t(n.cols,n.rows)};for(var i=0;i<this.cols;i++)this.board[i]=[]}return _createClass(t,[{key:"get",value:function(t){var n=t.x,e=t.y;return this.board[n]?this.board[n][e]:void 0}},{key:"set",value:function(t,n){var e=t.x,r=t.y;this.board[e][r]=n}},{key:"setIfAble",value:function(t,n){var e=!1;return this.winner||(this.get(n)||(this.set(n,t),e=!0),this.checkWinner()),e}},{key:"setNextTurn",value:function(t){var n=!1;return t&&this.setIfAble(this.getTurn(),t)&&(this.nextTurn(),n=!0),n}},{key:"takeTurn",value:function(t){this.setNextTurn(t)}},{key:"nextTurn",value:function(){return this.turns++%2==0?"X":"O"}},{key:"getTurn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.turns;return t%2==0?"X":"O"}},{key:"checkWinner",value:function(){var t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(t=this.checkColWins())||(t=this.checkRowWins())||(t=this.checkDiagonalWins())||this.checkBoardFull()&&(t="tie"),n&&(this.winner=t),t}},{key:"checkColWins",value:function(){for(var t=0;t<this.cols;t++){for(var n=this.get({x:t,y:0}),e=1;e<this.rows;e++)n!==this.get({x:t,y:e})&&(n=void 0);if(n)return n}}},{key:"checkRowWins",value:function(){for(var t=0;t<this.cols;t++){for(var n=this.get({x:0,y:t}),e=1;e<this.rows;e++)n!==this.get({x:e,y:t})&&(n=void 0);if(n)return n}}},{key:"checkDiagonalWins",value:function(){for(var t=this.get({x:0,y:0}),n=this.get({x:0,y:this.rows-1}),e=1;e<this.cols;e++)t!==this.get({x:e,y:e})&&(t=void 0),n!==this.get({x:e,y:this.rows-1-e})&&(n=void 0);return t||n}},{key:"checkBoardFull",value:function(){for(var t=0;t<this.cols;t++)for(var n=0;n<this.rows;n++)if(!this.get({x:t,y:n}))return!1;return!0}}]),t}(),l=e("YTka"),c=function(t){for(var n=t.length-1;n>0;n--){var e=Math.floor(Math.random()*(n+1)),r=[t[e],t[n]];t[n]=r[0],t[e]=r[1]}return t},h=function(t){function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(l.randomInt)(0)(2);return _classCallCheck(this,n),(t=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,e,r))).aiPlayer=i,t.next=function(){return new n(t.cols,t.rows)},t.bestMove=function(){return t.minimax().move},t.scores=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"tie"===n?0:n===t.getTurn()?10-e:-10+e},t.player=function(n){return n?t.getTurn():t.getTurn(t.turns+1)},t.isAiTurn=function(){return t.turns%2===t.aiPlayer},t}return _inherits(n,t),_createClass(n,[{key:"takeTurn",value:function(t){if(this.isAiTurn()&&!this.checkWinner()){for(;!this.setNextTurn(this.bestMove()););this.checkWinner()}else this.setNextTurn(t)}},{key:"getAvailableMoves",value:function(){for(var t=[],n=0;n<this.cols;n++)for(var e=0;e<this.rows;e++)this.get({x:n,y:e})||t.push(s.Point.create(n,e));return t}},{key:"minimax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1/0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=t.checkWinner(!1);if(void 0!==a)return{score:this.scores(a,n)};var o,s=c(t.getAvailableMoves()),u=i?-1/0:1/0,l=function(t,n){return i?t>n:t<n},h=!0,f=!1,d=void 0;try{for(var v,g=s[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value;t.set(y,this.player(i));var w=this.minimax(t,n+1,e,r,!i),m=w.score;if(t.set(y,void 0),l(m,u)&&(u=m,o=y),i?e=Math.max(e,m):r=Math.min(r,m),r<=e)break}}catch(b){f=!0,d=b}finally{try{h||null==g.return||g.return()}finally{if(f)throw d}}return{score:u,move:o}}}]),n}(u),f=.9,d=((r=function(t){function n(t,e){var r;return _classCallCheck(this,n),(r=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,t,e))).draw=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.ctx;t.save(),t.fillStyle=n.BACKGROUND_COLOR,t.fillRect(0,0,r.canvas.width,r.canvas.height),t.lineWidth=.01*r.canvas.width,t.strokeStyle="rgb(200,200,200)";for(var e=r.canvas.height*(1-f)/2,i=1;i<r.grid.cols;i++)s.Line.draw(t,{start:s.Point.create(r.x(i),r.y(0)*f+e),end:s.Point.create(r.x(i),r.y(r.grid.rows)*f+e)});for(var a=r.canvas.width*(1-f)/2,o=1;o<r.grid.cols;o++)s.Line.draw(t,{start:s.Point.create(r.x(0)*f+a,r.y(o)),end:s.Point.create(r.x(r.grid.rows)*f+a,r.y(o))});t.restore()},r}return _inherits(n,t),n}(s.Animators.CanvasGridAnimator)).BACKGROUND_COLOR="#232323",r),v=f,g=function(t){return"human"===t?"#33ff33":"ai"===t?"#ff3333":"white"},y=function(t){return t instanceof h?function(n){return n===(t.aiPlayer?"O":"X")?"ai":"human"}:function(){}},w=function(t){function n(t,e){var r;return _classCallCheck(this,n),(r=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,t,e))).draw=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ctx;r.clear();var e=y(t);n.lineWidth=.01*r.canvas.width;for(var i=0;i<t.cols;i++)for(var a=0;a<t.rows;a++){var o=t.get({x:i,y:a});r.drawMarker(o,e(o))(n,i,a)}},r.drawMarker=function(t,n){switch(t){case"X":return r.drawMarkerX(n);case"O":return r.drawMarkerO(n);default:return function(){}}},r.drawMarkerX=function(t){return function(n,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g(t);n.save();var o=r.x(1),u=r.y(1),l=r.canvas.width*(1-v)/2,c=r.canvas.height*(1-v)/2;n.strokeStyle=a,s.Line.draw(n,{start:s.Point.create(r.x(e)+l,r.y(i)+c),end:s.Point.create(r.x(e)+o-l,r.y(i)+u-c)}),s.Line.draw(n,{start:s.Point.create(r.x(e)+l,r.y(i)+u-c),end:s.Point.create(r.x(e)+o-l,r.y(i)+c)}),n.restore()}},r.drawMarkerO=function(t){return function(n,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g(t);n.save();var o=r.x(1),s=r.y(1),u=r.canvas.width*(1-v)/2,l=r.canvas.height*(1-v)/2,c=(Math.min(o,s)*v-Math.min(u,l))/2;n.strokeStyle=a,n.beginPath(),n.arc(r.x(e)+o/2,r.y(i)+s/2,c,0,2*Math.PI),n.stroke(),n.closePath(),n.restore()}},r}return _inherits(n,t),n}(s.Animators.CanvasGridAnimator),m=function(t){function n(t,e){var r;return _classCallCheck(this,n),(r=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,t,e))).draw=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ctx;t.winner&&(r.clear(),r.drawText(n,t.winner,t.isAiTurn()?"human":"ai"))},r.drawText=function(t,n,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.canvas.width/2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.canvas.height/2,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s.Text.getFont(r.y(1)),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"rgba(100,100,100,0.95)",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:g("tie"===n?"tie":e);t.save(),t.fillStyle=u,t.fillRect(0,r.y(1),r.canvas.width,r.y(1)),s.Text.draw(t,{text:"tie"===n?"tie!":n+" wins!",x:i,y:a,maxWidth:r.canvas.width*f,font:o,fillStyle:l}),t.restore()},r}return _inherits(n,t),n}(s.Animators.CanvasGridAnimator),b=function(){function t(n,e,r){var i,a=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new h;_classCallCheck(this,t),this.state=o,this.fps=60,this.update=function(t){return function(n){n-t>1e3/a.fps?(a.state.takeTurn(),a.gameAnimator.draw(a.state),a.state.winner?(a.uiAnimator.draw(a.state),a.state=a.state.next(),setTimeout((function(){a.animationFrameId=window.requestAnimationFrame(a.update(n))}),2e3)):(a.uiAnimator.clear(),a.animationFrameId=window.requestAnimationFrame(a.update(n)))):a.animationFrameId=window.requestAnimationFrame(a.update(t))}},this.gameAnimator=new w(n,o),this.backgroundAnimator=new d(e,o),this.uiAnimator=new m(r,o);for(var u=function(t){return Math.round(t*r.width/a.state.cols)},l=function(t){return Math.round(t*r.height/a.state.rows)},c=[],f=function(t){for(var n=function(n){c.push({x:u(t),y:l(n),width:u(1),height:l(1),enabled:!0,onClick:function(){a.state.takeTurn({x:t,y:n})}})},e=0;e<o.rows;e++)n(e)},v=0;v<o.cols;v++)f(v);(i=s.Mouse).addClickEventListener.apply(i,[r].concat(c))}return _createClass(t,[{key:"start",value:function(){this.backgroundAnimator.draw(),this.gameAnimator.draw(this.state),this.animationFrameId=window.requestAnimationFrame(this.update(0))}},{key:"ngOnDestroy",value:function(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId)}}]),t}(),k=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){this.scaleCanvas(),this.animator=new b(document.getElementById("game-layer"),document.getElementById("background-layer"),document.getElementById("ui-layer")),this.animator.start()}},{key:"ngOnDestroy",value:function(){this.animator.ngOnDestroy()}},{key:"scaleCanvas",value:function(t){var n=document.getElementById("menu"),e=document.getElementById("main"),r=document.getElementById("stage"),i=document.getElementById("background-layer"),a=(window.innerHeight-n.offsetHeight-10)/i.height,o=e.offsetWidth/i.width,s=Math.min(o,a);Math.max(o,a),r.style.transformOrigin="0 0",r.style.transform="scale("+s+")"}}]),t}(),p=i.vb({encapsulation:0,styles:[["#stage[_ngcontent-%COMP%]{width:900px;height:900px;position:relative;box-sizing:content-box;border:1px solid;background-color:#fff}#stage[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute}#stage[_ngcontent-%COMP%]   #ui-layer[_ngcontent-%COMP%]{z-index:3}#stage[_ngcontent-%COMP%]   #game-layer[_ngcontent-%COMP%]{z-index:2}#stage[_ngcontent-%COMP%]   #background-layer[_ngcontent-%COMP%]{z-index:1}"]],data:{}});function x(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,3,"div",[["id","stage"]],null,null,null,null,null)),(t()(),i.xb(1,0,null,null,0,"canvas",[["height","900"],["id","ui-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(2,0,null,null,0,"canvas",[["height","900"],["id","game-layer"],["width","900"]],null,null,null,null,null)),(t()(),i.xb(3,0,null,null,0,"canvas",[["height","900"],["id","background-layer"],["width","900"]],null,null,null,null,null))],null,null)}var _=i.tb("app-tic-tac-toe",k,(function(t){return i.Tb(0,[(t()(),i.xb(0,0,null,null,1,"app-tic-tac-toe",[],null,[["window","resize"]],(function(t,n,e){var r=!0;return"window:resize"===n&&(r=!1!==i.Jb(t,1).scaleCanvas(e)&&r),r}),x,p)),i.wb(1,245760,null,0,k,[],null,null)],(function(t,n){t(n,1,0)}),null)}),{},{},[]),C=e("SVse"),O=e("iInd"),P=function t(){_classCallCheck(this,t)};e.d(n,"TicTacToeModuleNgFactory",(function(){return M}));var M=i.ub(a,[],(function(t){return i.Gb([i.Hb(512,i.l,i.fb,[[8,[o.a,_]],[3,i.l],i.B]),i.Hb(4608,C.o,C.n,[i.x,[2,C.D]]),i.Hb(1073742336,C.b,C.b,[]),i.Hb(1073742336,O.o,O.o,[[2,O.t],[2,O.k]]),i.Hb(1073742336,P,P,[]),i.Hb(1073742336,a,a,[]),i.Hb(1024,O.i,(function(){return[[{path:"",component:k}]]}),[])])}))}}]);